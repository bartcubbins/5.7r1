--- arch/arm/boot/dts/qcom/msm8939-kanuti_tulip_common.dtsi
+++ arch/arm/boot/dts/qcom/msm8939-kanuti_tulip_common.dtsi
@@ -408,6 +408,7 @@
 
 &pm8916_chg {
 	status = "ok";
+	qcom,vbatweak-uv = <3800000>;
 	qcom,use-external-charger;
 };
 
@@ -417,6 +418,7 @@
 };
 
 &usb_otg {
+	qcom,max-nominal-sysclk-rate = <100000000>;
 	qcom,hsusb-otg-phy-init-seq =
 			<0x44 0x80 0x6B 0x81 0x30 0x82 0x13 0x83 0xffffffff>;
 	qcom,hsusb-otg-mode = <1>;
@@ -426,11 +428,6 @@
 	vbus_otg-supply = <&smb1360_otg_supply>;
 };
 
-&pmx_mdss {
-	qcom,num-grp-pins = <4>;
-	pins = "gpio114", "gpio17", "gpio25", "gpio10";
-};
-
 &mdss_dsi0_pll {
 	vddio-supply = <&pm8916_l16>;
 };
@@ -473,6 +470,7 @@
 		qcom,vin-sel = <3>;		/* VIN 3 = 1.8v */
 		qcom,out-strength = <2>;	/* Medium */
 		qcom,master-en = <1>;		/* Enable GPIO */
+		status = "ok";
 	};
 };
 
@@ -480,15 +478,19 @@
 /* Pinctrl */
 &msm_gpio {
 	hwid_pins {
-		qcom,pins = "gpio0", "gpio1", "gpio2", "gpio3",
-			    "gpio8", "gpio9", "gpio107", "gpio35";
-		function = "gpios";
-		qcom,num-grp-pins = <8>;
-		qcom,pin-func = <0>;
-		label = "fih_hwid_pin";
 		hwid_init: init {
-			drive-strength = <2>;
-			bias-disable;
+			mux {
+				pins = "gpio0", "gpio1", "gpio2", "gpio3",
+					"gpio8", "gpio9", "gpio107", "gpio35";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio0", "gpio1", "gpio2", "gpio3",
+					"gpio8", "gpio9", "gpio107", "gpio35";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
 
@@ -497,200 +499,358 @@
 	/delete-node/ spi0_cs0_active;
 	/delete-node/ spi0_cs0_suspend;
 
-	tlmm_gpio_key {
-		qcom,pins = "gpio108", "gpio109", "gpio51", "gpio11";
-		qcom,num-grp-pins = <4>;
-	};
-
-	ext-cdc-tlmm-lines { /* Verify me. CAF or FIH? */
-		qcom,pins = "gpio112", "gpio117", "gpio118", "gpio119";
-		qcom,num-grp-pins = <4>;
-	};
 
 	bma2x2_int_pin {
-		qcom,pins = "gpio69";
-		qcom,pin-func = <0>;
-		qcom,num-grp-pins = <1>;
-		label = "bma2x2-irq";
-
 		bma2x2_default: bma2x2_default {
-			drive-strength = <2>;
-			bias-disable; /* NO pull */
+			mux {
+				pins = "gpio69";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio69";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
+
 		bma2x2_sleep: bma2x2_sleep {
-			drive-strength = <2>;
-			bias-disable; /* NO pull */
+			mux {
+				pins = "gpio69";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio69";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
 
 	bmg160_int_pin {
-		qcom,pins = "gpio115";
-		qcom,pin-func = <0>;
-		qcom,num-grp-pins = <1>;
-		label = "bmg160-irq";
-
 		bmg160_default: bmg160_default {
-			drive-strength = <2>;
-			bias-disable; /* NO pull */
+			mux {
+				pins = "gpio115";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio115";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
+
 		bmg160_sleep: bmg160_sleep {
-			drive-strength = <2>;
-			bias-disable; /* NO pull */
+			mux {
+				pins = "gpio115";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio115";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
 
-	cm36286_int_active {
-		qcom,pins = "gpio113";
-		qcom,pin-func = <0>;
-		qcom,num-grp-pins = <1>;
-		label = "cm36286_irq_active";
-
+	cm36286_int_pin {
 		cm_int_active: cm_int_active {
-			drive-strength = <16>;
-			bias-pull-up;
-		};
-	};
+			mux {
+				pins = "gpio113";
+				function = "gpio";
+			};
 
-	cm36286_int_suspend {
-		qcom,pins = "gpio113";
-		qcom,pin-func = <0>;
-		qcom,num-grp-pins = <1>;
-		label = "cm36286_irq_suspend";
+			config {
+				pins = "gpio113";
+				drive-strength = <16>;
+				bias-pull-up;
+			};
+		};
 
 		cm_int_suspend: cm_int_suspend {
-			drive-strength = <16>;
-			bias-disable;
+			mux {
+				pins = "gpio113";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio113";
+				drive-strength = <16>;
+				bias-disable;
+			};
 		};
 	};
 
 	tlmm_lp5562 { /* LED IC lp5562 */
-		qcom,pins = "gpio32";
-		qcom,pin-func = <0>;
-		qcom,num-grp-pins = <1>;
-		label = "tlmm_lp5562";
-
 		lp5562_active: lp5562_active {
-			drive-strength = <2>;
-			bias-pull-up;
+			mux {
+				pins = "gpio32";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio32";
+				drive-strength = <2>;
+				bias-pull-up;
+			};
 		};
+
 		lp5562_suspend: lp5562_suspend {
-			drive-strength = <2>;
-			bias-pull-up;
+			mux {
+				pins = "gpio32";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio32";
+				drive-strength = <2>;
+				bias-pull-up;
+			};
 		};
 	};
 
-	ext-codec-lines {
-		qcom,pins = "gpio67";
-		qcom,num-grp-pins = <1>;
-		qcom,pin-func = <0>;
-		label = "ext-codec-lines";
+	cam_sensor_rear_sleep_np {
+		cam_sensor_rear_sleep_np: lp5562_suspend {
+			mux {
+				pins = "gpio28", "gpio33", "gpio34";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio28", "gpio33", "gpio34";
+				drive-strength = <2>;
+				bias-disable;
+			};
+		};
+	};
 
+	ext-codec-lines {
 		ext_codec_lines_act: lines_on {
-			drive-strength = <8>;
-			bias-disable;
-			output-high;
+			mux {
+				pins = "gpio67";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio67";
+				drive-strength = <8>;
+				output-high;
+				bias-disable;
+			};
 		};
+
 		ext_codec_lines_sus: lines_off {
-			drive-strength = <2>;
-			bias-disable;
+			mux {
+				pins = "gpio67";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio67";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
 
-	cdc-ext-pa-lines {
-		qcom,pins = "gpio113", "gpio114", "gpio115";
-		qcom,num-grp-pins = <3>;
-		qcom,pin-func = <1>;
-		label = "cdc-ext-pa-lines";
+	cdc-ext-pa {
+		cdc_ext_pa_act: lines_on {
+			mux {
+				pins = "gpio113", "gpio114", "gpio115";
+				function = "gpio";
+			};
 
-		cdc_ext_pa_act: ext_pa_on {
-			drive-strength = <8>;
-			bias-pull-none;
+			config {
+				pins = "gpio113", "gpio114", "gpio115";
+				drive-strength = <8>;
+				bias-pull-none;
+			};
 		};
-		cdc_ext_pa_sus: ext_pa_off {
-			drive-strength = <2>;
-			bias-disable;
+
+		cdc_ext_pa_sus: lines_off {
+			mux {
+				pins = "gpio113", "gpio114", "gpio115";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio113", "gpio114", "gpio115";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
 
 	cdc-ext-pa-ws-line {
-		qcom,pins = "gpio110";
-		qcom,num-grp-pins = <1>;
-		qcom,pin-func = <2>;
-		label = "cdc-ext-pa-ws-line";
-
-		cdc_ext_pa_ws_act: ext_pa_on {
-			drive-strength = <8>;
-			bias-pull-none;
+		cdc_ext_pa_ws_act: lines_on {
+			mux {
+				pins = "gpio110";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio110";
+				drive-strength = <8>;
+				bias-pull-none;
+			};
 		};
-		cdc_ext_pa_ws_sus: ext_pa_off {
-			drive-strength = <2>;
-			bias-disable;
+
+		cdc_ext_pa_ws_sus: lines_off {
+			mux {
+				pins = "gpio110";
+				function = "gpio";
+			};
+
+			config {
+				pins = "gpio110";
+				drive-strength = <2>;
+				bias-disable;
+			};
 		};
 	};
+};
 
-	cam_sensor_rear {
-		qcom,pins =  "gpio28", "gpio33", "gpio34", "gpio36";
-		qcom,num-grp-pins = <4>;
+&gpio_key_active {
+	mux {
+		pins = "gpio108", "gpio109", "gpio51", "gpio11";
 	};
 
-	cam_sensor_rear_sleep {
-		qcom,pins =  "gpio36";
-		qcom,num-grp-pins = <1>;
+	config {
+		pins = "gpio108", "gpio109", "gpio51", "gpio11";
 	};
+};
 
-	cam_sensor_rear_sleep_np {
-		/* RESET, STANDBY */
-		qcom,pins =  "gpio28", "gpio33", "gpio34";
-		qcom,num-grp-pins = <3>;
-		qcom,pin-func = <0>;
-		label = "cam-sensor-rear-sleep-np";
-		/*suspended state */
-		cam_sensor_rear_sleep_np: sleep {
-			drive-strength = <2>; /* 2 MA */
-			bias-disable; /* No PULL */
-		};
+&gpio_key_suspend {
+	mux {
+		pins = "gpio108", "gpio109", "gpio51", "gpio11";
 	};
 
-	cam_sensor_front {
-		qcom,pins = "gpio121";
-		qcom,num-grp-pins = <1>;
+	config {
+		pins = "gpio108", "gpio109", "gpio51", "gpio11";
 	};
+};
 
-	cam_sensor_front_sleep {
-		qcom,pins = "gpio121";
-		qcom,num-grp-pins = <1>;
+&ext_cdc_tlmm_lines_act {
+	mux {
+		pins = "gpio112", "gpio117", "gpio118", "gpio119";
 	};
 
-	cam_sensor_flash {
-		qcom,pins = "gpio98", "gpio97" ;
-		qcom,num-grp-pins = <2>;
+	config {
+		pins = "gpio112", "gpio117", "gpio118", "gpio119";
 	};
 };
 
-&sdc2_cd_off {
-	bias-pull-up;
+&ext_cdc_tlmm_lines_sus {
+	mux {
+		pins = "gpio112", "gpio117", "gpio118", "gpio119";
+	};
+
+	config {
+		pins = "gpio112", "gpio117", "gpio118", "gpio119";
+	};
 };
 
-&usbid_default {
-	bias-pull-down;
+&cam_sensor_rear_default {
+	mux {
+		pins = "gpio28", "gpio33", "gpio34", "gpio36";
+	};
+
+	config {
+		pins = "gpio28", "gpio33", "gpio34", "gpio36";
+	};
 };
 
-&mdss_dsi_active {
-	/delete-property/ output-high;
-	output-low;
+&cam_sensor_rear_sleep {
+	mux {
+		pins = "gpio28", "gpio33", "gpio34", "gpio36";
+	};
+
+	config {
+		pins = "gpio28", "gpio33", "gpio34", "gpio36";
+	};
 };
 
 &cam_sensor_front_default {
-	/delete-property/ bias-disable;
-	bias-pull-down;
+	mux {
+		pins = "gpio121";
+	};
+
+	config {
+		pins = "gpio121";
+		/delete-property/ bias-disable;
+		bias-pull-down;
+	};
 };
 
 &cam_sensor_front_sleep {
-	bias-pull-down = <1>;
+	mux {
+		pins = "gpio121";
+	};
+
+	config {
+		pins = "gpio121";
+		bias-pull-down;
+	};
+};
+
+&cam_sensor_flash_default {
+	mux {
+		pins = "gpio98", "gpio97";
+	};
+
+	config {
+		pins = "gpio98", "gpio97";
+	};
 };
 
 &cam_sensor_flash_sleep {
-	bias-pull-down = <1>;
+	mux {
+		pins = "gpio98", "gpio97";
+	};
+
+	config {
+		pins = "gpio98", "gpio97";
+		bias-pull-down;
+	};
+};
+
+&sdc2_cd_off {
+	config {
+		/delete-property/ bias-disable;
+		bias-pull-up;
+	};
+};
+
+&usbid_default {
+	config {
+		/delete-property/ bias-pull-up;
+		bias-pull-down;
+	};
+};
+
+&mdss_dsi_active {
+	mux {
+		pins = "gpio114", "gpio17", "gpio25", "gpio10";
+	};
+
+	config {
+		pins = "gpio114", "gpio17", "gpio25", "gpio10";
+		/delete-property/ output-high;
+		output-low;
+	};
+};
+
+&mdss_dsi_suspend {
+	mux {
+		pins = "gpio114", "gpio17", "gpio25", "gpio10";
+	};
+
+	config {
+		pins = "gpio114", "gpio17", "gpio25", "gpio10";
+	};
 };
 
 
